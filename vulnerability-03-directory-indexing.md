# üìÇ Vulnerability 03: Directory Indexing Enabled (Information Disclosure)

## üìã Vulnerability Overview

**Vulnerability Type**: Directory Indexing Enabled (Information Disclosure)  
**CVSS Score**: 5.3 (Medium)  
**CWE**: CWE-548: Exposure of Information Through Directory Listing  
**OWASP**: A01 Security Misconfiguration  

## üéØ Description

Web vulnerability scanning revealed that directory indexing is enabled on the WordPress uploads directory (/secret/wp-content/uploads/). This misconfiguration allows unauthorized users to browse the directory structure and view all uploaded files without authentication. The vulnerability was confirmed through both automated scanning (Nikto) and manual verification via web browser. The directory listing exposes file names, modification dates, and reveals sensitive server information including Apache version (2.4.18) and server hostname details.

## üîç Discovery Process

### Automated Discovery with Nikto
- Nikto web vulnerability scanner identified directory indexing
- Systematic scan of web application structure
- Detection of sensitive directory exposure

### Manual Verification
- Direct browser access to uploads directory
- Confirmation of directory listing functionality
- Analysis of exposed information

## üíª Exploitation Methodology

### Phase 1: Automated Vulnerability Discovery

```bash
# 1. Run Nikto web vulnerability scanner
nikto -h http://10.0.0.13/secret/

# Key Finding:
# + /secret/wp-content/uploads/: Wordpress uploads directory is browsable. 
#   This may reveal sensitive information.
```

### Phase 2: Manual Verification

```bash
# 2. Test directory browsing via browser
firefox http://10.0.0.13/secret/wp-content/uploads/

# 3. Explore subdirectories
firefox http://10.0.0.13/secret/wp-content/uploads/2025/

# 4. Command line verification
curl http://10.0.0.13/secret/wp-content/uploads/
```

### Phase 3: Information Gathering

```bash
# 5. Analyze exposed directory structure
# - File listing with timestamps
# - Server information disclosure
# - Directory hierarchy exposure
# - Potential sensitive file discovery
```

## üì∏ Evidence Screenshots

### Screenshot 1: Nikto Vulnerability Scan Results
![image](https://github.com/user-attachments/assets/ca29b45b-6b6f-4912-97a0-64ad0eb2b0d2)

*Figure 1: Nikto web vulnerability scanner identifying directory indexing vulnerability*

### Screenshot 2: Directory Structure Exposure
![image](https://github.com/user-attachments/assets/b6660edb-90f4-48f6-9634-cce2c34bcce5)

*Figure 2: Exposed directory structure revealing file organization and modification dates*

## üé• Video Demonstration

### üì∫ YouTube Demo
**Video Title**: "HomeLab_PenTest_3"  
**Duration**: ~2 minute  
**YouTube Link**: `https://www.youtube.com/watch?v=eKpmSRg_4FY&ab_channel=DominicQi`


## üìä Risk Assessment

### Impact Analysis
- **Confidentiality**: Medium - Information disclosure and reconnaissance aid
- **Integrity**: Low - No direct data modification capability
- **Availability**: Low - No direct impact on system availability

### Business Impact
- **Information Disclosure**: Exposes internal file structure and organization
- **Reconnaissance Aid**: Provides attackers with system intelligence
- **Privacy Concerns**: Potential exposure of user-uploaded sensitive content
- **Compliance Issues**: May violate data protection regulations
- **Professional Image**: Reflects poor security configuration practices

### Attack Scenarios
1. **Reconnaissance Enhancement**: Gather intelligence for targeted attacks
2. **Sensitive File Discovery**: Locate configuration files or backups
3. **User Data Exposure**: Access user-uploaded private documents
4. **System Fingerprinting**: Identify server versions for targeted exploits
5. **Social Engineering**: Use exposed information for phishing attacks

## üîç Information Disclosed

### File System Information
- Directory structure and organization
- File names and extensions
- File modification timestamps
- File sizes and permissions

### Server Information
- Apache web server version (2.4.18)
- Server hostname and configuration details
- Operating system indicators
- PHP and WordPress installation details

### Potential Sensitive Data
- User-uploaded documents and files
- Configuration file backups
- Temporary files and logs
- Database dumps or backups

## üõ°Ô∏è Remediation Recommendations

### Immediate Actions (Critical - Implement Now)
1. **Disable Directory Indexing**
   ```apache
   # Add to .htaccess in wp-content/uploads/
   Options -Indexes
   
   # Or add to Apache configuration
   <Directory "/var/www/html/secret/wp-content/uploads">
       Options -Indexes
   </Directory>
   ```

2. **Web Server Configuration**
   ```apache
   # Disable directory browsing globally
   <Directory />
       Options -Indexes
   </Directory>
   ```

3. **File Access Controls**
   ```apache
   # Restrict access to sensitive files
   <Files "*.conf">
       Order allow,deny
       Deny from all
   </Files>
   ```

### Short-term Fixes (Implement Within 24 Hours)
1. **WordPress Security Configuration**
   ```php
   // Add to wp-config.php
   define('DISALLOW_FILE_EDIT', true);
   define('DISALLOW_FILE_MODS', true);
   ```

2. **Upload Directory Security**
   ```apache
   # Create .htaccess in uploads directory
   # Prevent PHP execution in uploads
   <Files "*.php">
       Order allow,deny
       Deny from all
   </Files>
   ```

3. **Server Information Hiding**
   ```apache
   # Hide server version information
   ServerTokens Prod
   ServerSignature Off
   ```

### Long-term Security Measures
1. **Security Headers Implementation**
   ```apache
   # Add security headers
   Header always set X-Content-Type-Options nosniff
   Header always set X-Frame-Options DENY
   Header always set X-XSS-Protection "1; mode=block"
   ```

2. **Regular Security Auditing**
   - Automated vulnerability scanning
   - Regular configuration reviews
   - Security monitoring implementation

3. **File Management Best Practices**
   - Move sensitive uploads outside web root
   - Implement file type restrictions
   - Regular cleanup of temporary files

## üîß Technical Configuration Details

### Apache Configuration Fix
```apache
# /etc/apache2/apache2.conf or .htaccess
<Directory /var/www/>
    Options Indexes FollowSymLinks  # Remove 'Indexes'
    AllowOverride None
    Require all granted
</Directory>

# Better configuration:
<Directory /var/www/>
    Options FollowSymLinks
    AllowOverride None
    Require all granted
</Directory>
```

### WordPress Specific Protection
```apache
# wp-content/uploads/.htaccess
Options -Indexes
<Files "*.php">
    Order allow,deny
    Deny from all
</Files>
```

### Nginx Configuration (Alternative)
```nginx
location /wp-content/uploads/ {
    autoindex off;
    location ~ \.php$ {
        deny all;
    }
}
```

## üìã Verification Steps

### Testing Directory Indexing Fix
```bash
# 1. Test directory access after fix
curl -I http://10.0.0.13/secret/wp-content/uploads/

# Expected: 403 Forbidden or redirect
# Not: 200 OK with directory listing

# 2. Verify with web browser
# Should show 403 Forbidden instead of file listing

# 3. Test with Nikto again
nikto -h http://10.0.0.13/secret/
# Should not report directory indexing vulnerability
```

## üìö References and Further Reading

- [CWE-548: Exposure of Information Through Directory Listing](https://cwe.mitre.org/data/definitions/548.html)
- [OWASP Security Misconfiguration](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/)
- [Apache Directory Index Documentation](https://httpd.apache.org/docs/2.4/mod/mod_autoindex.html)
- [WordPress Security Hardening Guide](https://wordpress.org/support/article/hardening-wordpress/)
- [Web Server Security Configuration](https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html)

---

**üîí Security Impact**: While classified as medium severity, this vulnerability provides valuable reconnaissance information that can be leveraged in combination with other vulnerabilities to enhance attack effectiveness and system compromise.
